import{u as e}from"./auth-Dc6Sz62s.mjs";import{u as r}from"./useApi-BJ4m0sc6.mjs";import{v as t,n as o}from"./server.mjs";const useAuth=()=>{const s=e(),{login:a,register:i,logout:n,getUser:c,updateProfile:u}=r(),l=t.computed(()=>s.user?.is_verified??!1);return{user:s.user,isAuthenticated:s.isAuthenticated,isProvider:s.isProvider,isSeeker:s.isSeeker,isLoading:s.isLoading,isVerified:l,login:async e=>{try{s.setLoading(!0);const r=await a(e);s.setUser(r.user),s.setToken(r.token);const t=s.getDashboardRoute();return await o(t),r}catch(e){throw console.error("Login error:",e),e}finally{s.setLoading(!1)}},register:async e=>{try{s.setLoading(!0);const r=await i(e);s.setUser(r.user),s.setToken(r.token);const t=s.getDashboardRoute();return await o(t),r}catch(e){throw console.error("Registration error:",e),e}finally{s.setLoading(!1)}},logout:async()=>{try{if(s.setLoading(!0),s.token)try{await n()}catch(e){console.warn("Logout API call failed:",e)}s.clearAuth(),await o("/auth/login")}catch(e){console.error("Logout error:",e),s.clearAuth(),await o("/auth/login")}finally{s.setLoading(!1)}},fetchUser:async()=>{try{if(!s.token)throw new Error("No authentication token");const e=await c();return s.setUser(e),e}catch(e){throw console.error("Fetch user error:",e),s.clearAuth(),e}},updateProfile:async e=>{try{s.setLoading(!0);const r=await u(e);return s.setUser(r),r}catch(e){throw console.error("Update profile error:",e),e}finally{s.setLoading(!1)}},hasRole:e=>s.user?.user_type===e,getDashboardRoute:s.getDashboardRoute}};export{useAuth as u};
//# sourceMappingURL=useAuth-Df92Orhw.mjs.map
